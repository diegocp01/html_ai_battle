<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dog Fetch Animation</title>
    <style>
        /* --- Environment --- */
        body {
            margin: 0;
            overflow: hidden;
            background: linear-gradient(to bottom, #87CEEB 60%, #90EE90 60%);
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            height: 100vh;
        }

        #game-container {
            position: relative;
            width: 100%;
            height: 100%;
            cursor: crosshair;
        }

        .instructions {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            color: #fff;
            font-size: 24px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
            pointer-events: none;
            user-select: none;
        }

        /* --- The Ball --- */
        #ball {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #ff4757;
            border-radius: 50%;
            border: 2px solid #2f3542;
            box-sizing: border-box;
            bottom: 40%; /* Starting position matching ground */
            left: 100px;
            transform: translate(-50%, 0);
            z-index: 5;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }

        /* --- The Dog (Pure CSS) --- */
        #dog {
            position: absolute;
            bottom: 40%; /* On the "ground" line */
            left: 50px;
            width: 80px;
            height: 50px;
            z-index: 10;
            transition: transform 0.2s; /* Smooth turning */
        }

        /* Dog Body Parts */
        .dog-body {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #eccc68;
            border-radius: 10px;
            border: 3px solid #57606f;
            box-sizing: border-box;
        }

        .dog-head {
            position: absolute;
            top: -30px;
            right: -10px;
            width: 45px;
            height: 45px;
            background-color: #eccc68;
            border-radius: 8px;
            border: 3px solid #57606f;
            box-sizing: border-box;
            z-index: 2;
        }

        .dog-ear {
            position: absolute;
            top: 5px;
            right: 15px;
            width: 12px;
            height: 25px;
            background-color: #57606f;
            border-radius: 10px;
            z-index: 3;
        }

        .dog-nose {
            position: absolute;
            top: 15px;
            right: -5px;
            width: 10px;
            height: 10px;
            background-color: #2f3542;
            border-radius: 50%;
        }

        .dog-eye {
            position: absolute;
            top: 12px;
            right: 15px;
            width: 6px;
            height: 6px;
            background-color: #2f3542;
            border-radius: 50%;
        }

        .dog-tail {
            position: absolute;
            top: 5px;
            left: -10px;
            width: 10px;
            height: 35px;
            background-color: #57606f;
            border-radius: 5px;
            transform-origin: bottom center;
            animation: wag 0.5s infinite alternate ease-in-out;
        }

        /* Legs */
        .dog-leg {
            position: absolute;
            bottom: -15px;
            width: 12px;
            height: 25px;
            background-color: #eccc68;
            border: 3px solid #57606f;
            border-radius: 5px;
            transform-origin: top center;
            box-sizing: border-box;
        }

        .leg-front { right: 10px; }
        .leg-back { left: 10px; }

        /* Animation States */
        .running .leg-front { animation: run 0.3s infinite alternate; }
        .running .leg-back { animation: run 0.3s infinite alternate-reverse; }
        
        .idle .dog-head { animation: bob 2s infinite ease-in-out; }

        /* --- Animations --- */
        @keyframes wag {
            0% { transform: rotate(-15deg); }
            100% { transform: rotate(15deg); }
        }

        @keyframes run {
            0% { transform: rotate(-30deg); }
            100% { transform: rotate(30deg); }
        }

        @keyframes bob {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(2px); }
        }

        /* --- Text Bubble --- */
        .bark-bubble {
            position: absolute;
            top: -60px;
            right: -20px;
            background: white;
            padding: 5px 10px;
            border-radius: 10px;
            border: 2px solid #333;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.2s;
        }
    </style>
</head>
<body>

<div id="game-container">
    <div class="instructions">Click anywhere on the grass to throw the ball!</div>
    
    <div id="ball"></div>
    
    <div id="dog" class="idle">
        <div class="dog-tail"></div>
        <div class="dog-leg leg-back"></div>
        <div class="dog-leg leg-front"></div>
        <div class="dog-body"></div>
        <div class="dog-head">
            <div class="dog-ear"></div>
            <div class="dog-eye"></div>
            <div class="dog-nose"></div>
            <div class="bark-bubble">Woof!</div>
        </div>
    </div>
</div>

<script>
    // --- Configuration ---
    const CONFIG = {
        groundHeight: window.innerHeight * 0.4, // Matches CSS bottom: 40%
        dogSpeed: 8,
        dogStartX: 50,
        gravity: 0.8
    };

    // --- State Management ---
    const STATE = {
        IDLE: 'idle',
        THROWN: 'thrown',
        FETCHING: 'fetching',
        RETURNING: 'returning'
    };

    let currentState = STATE.IDLE;
    
    // --- Elements ---
    const dogElem = document.getElementById('dog');
    const ballElem = document.getElementById('ball');
    const bubbleElem = document.querySelector('.bark-bubble');
    const container = document.getElementById('game-container');

    // --- Physics Variables ---
    let dogPos = { x: CONFIG.dogStartX };
    let ballPos = { x: 100, y: 0 }; // y is height from ground
    let ballVel = { x: 0, y: 0 };
    let targetX = 0;

    // --- Game Loop ---
    function update() {
        // 1. Handle Ball Physics
        if (currentState === STATE.THROWN) {
            ballPos.x += ballVel.x;
            ballPos.y += ballVel.y;
            ballVel.y -= CONFIG.gravity; // Apply gravity

            // Ground collision
            if (ballPos.y <= 0) {
                ballPos.y = 0;
                ballVel.y = -ballVel.y * 0.6; // Bounce with damping
                ballVel.x *= 0.8; // Friction

                // Stop if slow enough
                if (Math.abs(ballVel.y) < 2 && Math.abs(ballVel.x) < 0.5) {
                    ballVel.y = 0;
                    ballVel.x = 0;
                    currentState = STATE.FETCHING; // Dog starts running now
                }
            }
        }

        // 2. Handle Dog Movement
        if (currentState === STATE.FETCHING) {
            const dist = ballPos.x - dogPos.x;
            
            // Face direction
            if (dist > 0) dogElem.style.transform = 'scaleX(1)'; 
            else dogElem.style.transform = 'scaleX(-1)';

            dogElem.classList.add('running');
            dogElem.classList.remove('idle');

            // Move
            if (Math.abs(dist) > 10) {
                dogPos.x += Math.sign(dist) * CONFIG.dogSpeed;
            } else {
                // Arrived at ball
                currentState = STATE.RETURNING;
                bark();
            }
        } else if (currentState === STATE.RETURNING) {
            const dist = CONFIG.dogStartX - dogPos.x;
            
            // Face home
            if (dist > 0) dogElem.style.transform = 'scaleX(1)';
            else dogElem.style.transform = 'scaleX(-1)';

            if (Math.abs(dist) > 10) {
                dogPos.x += Math.sign(dist) * CONFIG.dogSpeed;
                
                // Carry the ball
                // We adjust ball position relative to dog's mouth direction
                const offset = (dist > 0) ? 30 : -30;
                ballPos.x = dogPos.x + offset; 
                ballPos.y = 20; // Lift ball
            } else {
                // Arrived home
                currentState = STATE.IDLE;
                dogElem.classList.remove('running');
                dogElem.classList.add('idle');
                dogElem.style.transform = 'scaleX(1)'; // Reset rotation
                
                // Drop ball
                ballPos.x = dogPos.x + 50;
                ballPos.y = 0;
            }
        }

        // --- Render ---
        // We use 'bottom' for Y positioning to align with CSS logic
        ballElem.style.left = ballPos.x + 'px';
        ballElem.style.bottom = (CONFIG.groundHeight + ballPos.y) + 'px';
        
        dogElem.style.left = dogPos.x + 'px';

        requestAnimationFrame(update);
    }

    // --- Input Handling ---
    container.addEventListener('mousedown', (e) => {
        // Only allow throw if idle or ball is resting
        if (currentState === STATE.IDLE || currentState === STATE.FETCHING) {
            if (currentState === STATE.FETCHING) {
                // If user clicks while dog is running, update target but reset physics
                // Logic simplified: just reset immediately for new throw
            }
            
            throwBall(e.clientX, window.innerHeight - e.clientY);
        }
    });

    function throwBall(targetMouseX, targetMouseY) {
        // Calculate velocity to hit target
        const startX = ballPos.x;
        const startY = ballPos.y;
        
        // Simple projectile logic
        const dx = targetMouseX - startX;
        // Add some upward arc regardless of click height to ensure it "throws"
        const vy = Math.max(15, (targetMouseY - CONFIG.groundHeight) * 0.05 + 10); 
        const vx = dx * 0.04; 

        ballVel = { x: vx, y: vy };
        currentState = STATE.THROWN;
        
        // Hide bubble if showing
        bubbleElem.style.opacity = 0;
    }

    function bark() {
        bubbleElem.style.opacity = 1;
        setTimeout(() => {
            bubbleElem.style.opacity = 0;
        }, 1000);
    }

    // Initialize position
    update();

</script>
</body>
</html>